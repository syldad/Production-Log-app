<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Production Log v15.11 (FINAL)</title>
    
    <!-- PWA / Full-Screen Tags -->
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#F97316">
    <link rel="apple-touch-icon" href="icon-192.png">

    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #FFF8F0; }
        .modal { transition: opacity 0.3s ease; }
        .tab-button { transition: background-color 0.2s, color 0.2s; }
        .table-cell { padding: 10px; border-bottom: 1px solid #F3E8DB; }
        html { overflow-y: scroll; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #FFF8F0; }
        ::-webkit-scrollbar-thumb { background: #FDBA74; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #FB923C; }
        :focus-visible { outline: 2px solid #F97316; outline-offset: 2px; border-radius: 4px; }
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px 16px;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.2s ease;
            cursor: pointer;
            border: 1px solid transparent;
        }
        .btn-primary { background-color: #F97316; color: white; border-color: #F97316; }
        .btn-primary:hover { background-color: #EA580C; border-color: #EA580C; }
        .btn-secondary { background-color: #FED7AA; color: #9A3412; border-color: #FED7AA; }
        .btn-secondary:hover { background-color: #FDBA74; }
        .btn-danger { background-color: #DC2626; color: white; border-color: #DC2626; }
        .btn-danger:hover { background-color: #B91C1C; }
        .btn-outline { background-color: white; color: #EA580C; border-color: #FDBA74; }
        .btn-outline:hover { background-color: #FFF8F0; }
        .form-input {
            width: 100%;
            padding: 10px;
            border: 1px solid #FDBA74;
            border-radius: 8px;
            background-color: white;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .form-input:focus {
            border-color: #F97316;
            box-shadow: 0 0 0 2px #FDBA74;
            outline: none;
        }
        #custom-alert {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        #custom-alert.show {
            opacity: 1;
            pointer-events: auto;
        }
        .alert-box {
            background-color: white;
            padding: 24px;
            border-radius: 12px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        #custom-alert.show .alert-box {
            transform: scale(1);
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Global App Container -->
    <div class="container mx-auto max-w-7xl p-4">

        <!-- Header -->
        <header class="mb-6 flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0">
            <h1 class="text-3xl font-bold text-orange-600">Production Log v15.11</h1>
            <div class="flex space-x-2">
                <button id="btn-show-home" class="btn btn-primary">Home</button>
                <button id="btn-show-summary" class="btn btn-secondary">Summary</button>
            </div>
        </header>

        <!-- Main Content Area -->
        <main>

            <!-- Page: Home -->
            <div id="page-home">
                <!-- Log Selection -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <button id="btn-open-slurry" class="btn btn-primary h-24 text-xl">New Slurry Batch</button>
                    <button id="btn-open-shito-batch" class="btn btn-primary h-24 text-xl">New Shito Batch</button>
                    <button id="btn-open-shito-cooking" class="btn btn-primary h-24 text-xl">New Shito Cooking Log</button>
                </div>

                <!-- Tab Navigation for Logs -->
                <div class="mb-4 border-b border-orange-200">
                    <nav class="flex -mb-px space-x-6" aria-label="Tabs">
                        <button id="btn-tab-slurry" class="tab-button whitespace-nowrap py-4 px-1 border-b-2 border-orange-500 text-orange-600 font-medium text-lg">
                            Slurry Logs
                        </button>
                        <button id="btn-tab-shito-batch" class="tab-button whitespace-nowrap py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-lg">
                            Shito Batch Logs
                        </button>
                        <button id="btn-tab-shito-cooking" class="tab-button whitespace-nowrap py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-lg">
                            Shito Cooking Logs
                        </button>
                    </nav>
                </div>

                <!-- Tab Content: Slurry -->
                <div id="tab-slurry" class="tab-content bg-white rounded-lg shadow-md overflow-x-auto">
                    <div class="p-4 flex justify-between items-center">
                        <h2 class="text-xl font-semibold">Slurry Batch Records</h2>
                        <input type="text" id="search-slurry" class="form-input w-1/2 sm:w-1/3" placeholder="Search by batch, product...">
                    </div>
                    <table class="min-w-full">
                        <thead class="bg-orange-50">
                            <tr>
                                <th class="table-cell text-left font-medium">Date</th>
                                <th class="table-cell text-left font-medium">Batch #</th>
                                <th class="table-cell text-left font-medium">Product</th>
                                <th class="table-cell text-left font-medium">Line</th>
                                <th class="table-cell text-left font-medium">Brix</th>
                                <th class="table-cell text-left font-medium">Color L</th>
                                <th class="table-cell text-left font-medium">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="slurry-table-body" class="divide-y divide-orange-100">
                            <!-- Rows will be injected by JS -->
                        </tbody>
                    </table>
                </div>

                <!-- Tab Content: Shito Batch -->
                <div id="tab-shito-batch" class="tab-content hidden bg-white rounded-lg shadow-md overflow-x-auto">
                    <div class="p-4 flex justify-between items-center">
                        <h2 class="text-xl font-semibold">Shito Batch Records</h2>
                        <input type="text" id="search-shito-batch" class="form-input w-1/2 sm:w-1/3" placeholder="Search by batch, variant...">
                    </div>
                    <table class="min-w-full">
                        <thead class="bg-orange-50">
                            <tr>
                                <th class="table-cell text-left font-medium">Date</th>
                                <th class="table-cell text-left font-medium">Batch #</th>
                                <th class="table-cell text-left font-medium">Variant</th>
                                <th class="table-cell text-left font-medium">SKU</th>
                                <th class="table-cell text-left font-medium">Batch Size (T)</th>
                                <th class="table-cell text-left font-medium">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="shito-batch-table-body" class="divide-y divide-orange-100">
                            <!-- Rows will be injected by JS -->
                        </tbody>
                    </table>
                </div>

                <!-- Tab Content: Shito Cooking -->
                <div id="tab-shito-cooking" class="tab-content hidden bg-white rounded-lg shadow-md overflow-x-auto">
                    <div class="p-4 flex justify-between items-center">
                        <h2 class="text-xl font-semibold">Shito Cooking Records</h2>
                        <input type="text" id="search-shito-cooking" class="form-input w-1/2 sm:w-1/3" placeholder="Search by batch ID, cycle...">
                    </
